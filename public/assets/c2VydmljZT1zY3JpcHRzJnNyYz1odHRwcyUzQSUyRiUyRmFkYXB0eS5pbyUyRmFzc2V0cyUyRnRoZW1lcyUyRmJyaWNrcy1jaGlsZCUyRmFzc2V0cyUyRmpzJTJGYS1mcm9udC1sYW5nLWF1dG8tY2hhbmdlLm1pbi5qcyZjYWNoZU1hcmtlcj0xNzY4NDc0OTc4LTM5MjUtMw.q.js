!function(){let e=["zh","fr","de","ja","ko","pl","pt","ru","es","tr","ua","en"],t={ua:"uk",zh:"zh-hans",pt:"pt-pt"},r="Adapty:UserPrefLang",n={"en-us":"en","tr-tr":"tr","de-de":"de",uk:"ua","pl-pl":"pl","fr-fr":"fr","ru-ru":"ru","es-es":"es",ja:"ja","ko-kr":"ko","zh-hk":"zh","zh-tw":"zh","pt-pt":"pt"},a={getBrowserLanguage:function(){let t=navigator.languages||[navigator.language||navigator.userLanguage];for(let r of t){let n=r.toLowerCase().split("-")[0];if("be"===n||"by"===n)return"ru";if("uk"===n)return"ua";if(n.startsWith("zh"))return"zh";if(e.includes(n))return n}return"en"},getCurrentPageLanguage:function(){let e=(document.documentElement.getAttribute("lang")||"en-us").toLowerCase();return n[e]||"en"},getPreferredLanguage:function(){let t=localStorage.getItem(r);return t&&!e.includes(t)?(localStorage.removeItem(r),null):t},setPreferredLanguage:function(t){e.includes(t)&&localStorage.setItem(r,t)},preserveQueryParamsAndHash:function(e=[],t){let r=new URLSearchParams(window.location.search);e.forEach(e=>r.delete(e));let n=r.toString()?`?${r.toString()}`:"",a=window.location.hash||"",l=t.endsWith("/")?t:`${t}/`;return l+n+a},findAlternateLink:function(e){let r=t[e]||e,n=document.querySelectorAll('link[rel="alternate"]');for(let a of n)if(a.getAttribute("hreflang")===r)return a.getAttribute("href");return null},redirectTo:function(e){"adapty.io"===window.location.hostname&&window.location.href!==e&&window.location.replace(e)},removeQueryParamsFromUrl:function(e){let t=new URL(window.location.href);e.forEach(e=>t.searchParams.delete(e)),window.history.replaceState({},document.title,t.toString())},handleFirstVisit:function(){let e=a.getBrowserLanguage();a.setPreferredLanguage(e)},handleRepeatVisit:function(e){let t=a.getCurrentPageLanguage();if(t===e)return;if("en"!==t){a.setPreferredLanguage(t);return}let r=a.findAlternateLink(e);r&&a.redirectTo(a.preserveQueryParamsAndHash([],r))},handleExplicitEnglishPrefix:function(){let e=window.location.pathname.split("/").filter(Boolean);if("en"===e[0]){a.setPreferredLanguage("en");let t="/"+e.slice(1).join("/");return a.redirectTo(a.preserveQueryParamsAndHash([],window.location.origin+t)),!0}return!1},handleLangQueryParam:function(){let t=new URLSearchParams(window.location.search),r=t.get("lang")||t.get("language");if(!r||!e.includes(r))return!1;a.setPreferredLanguage(r);let n=a.getCurrentPageLanguage();if(n===r)return a.removeQueryParamsFromUrl(["lang","language"]),!0;if("en"===r){let l=window.location.pathname.split("/").filter(Boolean),i=l[0]&&e.includes(l[0])?"/"+l.slice(1).join("/"):window.location.pathname;return a.redirectTo(a.preserveQueryParamsAndHash(["lang","language"],window.location.origin+i)),!0}let u=a.findAlternateLink(r);return!!u&&(a.redirectTo(a.preserveQueryParamsAndHash(["lang","language"],u)),!0)},handleLanguageSwitchers:function(){document.querySelectorAll("li.wpml-ls-item-en > a.wpml-ls-link").forEach(e=>{let t=new URL(e.href,window.location.origin);e.href=t.toString(),e.addEventListener("click",e=>{e.preventDefault();let r=new URL(a.preserveQueryParamsAndHash([],t.toString()));r.searchParams.set("lang","en"),a.setPreferredLanguage("en"),a.redirectTo(r.toString())})}),document.querySelectorAll(".wpml-ls-item:not(.wpml-ls-item-en) > a.wpml-ls-link").forEach(t=>{if(t.closest("#theme-switcher"))return;let r=new URL(t.href,window.location.origin);t.href=r.toString(),t.addEventListener("click",t=>{t.preventDefault();let n=new URL(a.preserveQueryParamsAndHash([],r.toString())),l=r.pathname.split("/").filter(Boolean),i=l[0]&&e.includes(l[0])?l[0]:"en";a.setPreferredLanguage(i),a.redirectTo(n.toString())})})}};!function e(){let t=a.handleExplicitEnglishPrefix();t||a.handleLangQueryParam();let r=a.getPreferredLanguage();r?a.handleRepeatVisit(r):a.handleFirstVisit(),"complete"===document.readyState?a.handleLanguageSwitchers():window.addEventListener("load",()=>{a.handleLanguageSwitchers()})}()}();